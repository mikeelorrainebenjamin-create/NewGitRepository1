---
title: "Work sheet 4b"
author: "Mikee Lorraine S. Benjamin"
date: "2025-11-28"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---

## **1. 5×5 Matrix**
```{r}
vectorA <- 1:5
matrix_result <- matrix(0, nrow = 5, ncol = 5)

for (i in 1:5) {
  for (j in 1:5) {
    matrix_result[i, j] <- abs(i - j)
  }
}

matrix_result
```

---

## **2. Print "*" in pattern**
```{r}
for (i in 1:5) {
  for (j in 1:i) {
    cat("*\t")
  }
  cat("\n\n")
}
```

---

## **3. Fibonacci sequence from a chosen starting index up to 500**
*(Revised: No user input — knit-friendly)*

```{r}
fib_sequence <- function(start = 1) {

  a <- 0
  b <- 1
  count <- 0
  result <- c()

  repeat {
    if (count >= start) {
      if (b > 500) break
      result <- c(result, b)
    }

    temp <- a + b
    a <- b
    b <- temp
    count <- count + 1
  }

  return(result)
}

fib_sequence(1)
```

---

## **4a. Import Excel/CSV file**
```{r}
library(readxl)
data <- read_excel("import_march.xlsx")

head(data)
```

---

## **4b. Subset male and female**
```{r}
male_data <- subset(data, Students == "Male")
female_data <- subset(data, Students == "Female")

cat("Number of Male observations:", nrow(male_data), "\n")
cat("Number of Female observations:", nrow(female_data), "\n")
```

---

## **4c. Barplot of Male & Female**
```{r}
gender_counts <- table(data$Students)

barplot(
  gender_counts,
  main = "Number of Male and Female Observations",
  xlab = "Gender",
  ylab = "Count",
  col = c("pink", "lightblue"),
  legend.text = TRUE,
  args.legend = list(x = "topright", legend = names(gender_counts))
)
```

---

## **5. Pie Chart of Expenses**
```{r}
expenses <- c(60, 10, 5, 25)
categories <- c("Food", "Electricity", "Savings", "Miscellaneous")

percent <- round(expenses / sum(expenses) * 100)
labels <- paste(categories, percent, "%")

pie(
  expenses,
  labels = labels,
  col = c("orange", "skyblue", "lightgreen", "pink"),
  main = "Monthly Income Distribution of Dela Cruz Family"
)
```

---

## **6a. Structure of iris dataset**
```{r}
data(iris)
str(iris)
```

---

## **6b. Mean of 4 variables**
```{r}
iris_means <- data.frame(
  Sepal.Length = mean(iris$Sepal.Length),
  Sepal.Width  = mean(iris$Sepal.Width),
  Petal.Length = mean(iris$Petal.Length),
  Petal.Width  = mean(iris$Petal.Width)
)

iris_means
```

---

## **6c. Pie chart of Species**
```{r}
species_counts <- table(iris$Species)

pie(
  species_counts,
  main = "Iris Species Distribution",
  col = c("red", "blue", "green"),
  labels = paste(names(species_counts), species_counts)
)
```

---

## **6d. Subsets for each species**
```{r}
setosa     <- iris[iris$Species == "setosa", ]
versicolor <- iris[iris$Species == "versicolor", ]
virginica  <- iris[iris$Species == "virginica", ]

print("Last 6 rows: Setosa")
tail(setosa)

print("Last 6 rows: Versicolor")
tail(versicolor)

print("Last 6 rows: Virginica")
tail(virginica)
```

---

## **6e. Scatterplot of Sepal Length vs Width**
```{r}
plot(
  iris$Sepal.Length, iris$Sepal.Width,
  main = "Iris Dataset",
  sub = "Sepal width and length",
  xlab = "Sepal Length",
  ylab = "Sepal Width",
  pch = c(16, 17, 18)[as.numeric(iris$Species)],
  col = c("red", "blue", "green")[as.numeric(iris$Species)]
)

legend(
  "topright",
  legend = levels(iris$Species),
  pch = c(16, 17, 18),
  col = c("red", "blue", "green")
)
```

---

## **6f. Interpretation**
```{r}
"The scatterplot shows that Setosa forms a distinct cluster with smaller sepal length and relatively wider sepal width. Versicolor and Virginica overlap more, but Virginica tends to have larger measurements."
```

---

## **7a. Cleaning Alexa variations**
```{r}
library(readxl)
library(dplyr)

alexa <- read_xlsx("alexa-file.xlsx")

# Clean double whitespaces
alexa$variation <- gsub("  ", " ", alexa$variation)

head(alexa, 10)
```

---

## **7b. Count variations and save to RData**
```{r}
variations <- alexa %>% count(variation)
variations

save(variations, file = "variations.RData")
```

---

## **7c. Barplot of all Alexa variations**
```{r}
barplot(
  variations$n,
  names.arg = variations$variation,
  main = "Total Number of Alexa Variations",
  xlab = "Variation",
  ylab = "Count",
  col = rainbow(nrow(variations)),
  las = 2,
  cex.names = 0.7
)
```

---

## **7d. Side-by-side Black & White barplots**
```{r}
black_vars <- variations[grepl("Black", variations$variation), ]
white_vars <- variations[grepl("White", variations$variation), ]

par(mfrow = c(1, 2))

barplot(
  black_vars$n,
  names.arg = black_vars$variation,
  main = "Black Variations",
  xlab = "Variation",
  ylab = "Count",
  col = "black",
  las = 2,
  cex.names = 0.8
)

barplot(
  white_vars$n,
  names.arg = white_vars$variation,
  main = "White Variations",
  xlab = "Variation",
  ylab = "Count",
  col = "grey",
  las = 2,
  cex.names = 0.8
)

par(mfrow = c(1, 1))
```